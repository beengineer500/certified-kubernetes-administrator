### 175. RBAC (Role Based Access Control)
- Role Object(역할 개체) 생성
	- Rules(규칙) 섹션은 `apiGroups, resources, verbs` 3가지 섹션으로 나눌 수 있다.
	- 단일 역할에 대해 여러 규칙을 추가할 수 있다. 
	- 네임스페이스 단위이다.
```bash
vi developer-role.yaml
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: developer
rules:
- apiGroups: [""]    # Core 그룹의 경우, API Group 섹션을 비울 수 있다.
  resources: ["pods"]
  verbs: ["list", "gets", "create", "update", "delete"]
- apiGroups: [""]
  resources: ["ConfigMap"]
  verbs: ["create"]
---

kubectl apply -f developer-role.yaml
```

- Rolebinding 생성
	- 사용자를 해당 역할에 바인딩(연결)하기 위해 필요하다.
	- 네임스페이스 단위이다.
```bash
vi devuser-developer-binding.yaml
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: devuser-developer-binding
subjects:
- kind: User
  name: dev-user
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: role
  name: developer
  apiGroup: rbac.authorization.k8s.io
---

kubectl apply -f devuser-developer-binding.yaml
```


- 클러스터 내 role, rolebinding 목록 및 세부정보 확인
```bash
kubectl get roles

kubectl get rolebindings 

kubectl describe role <ROLE_NAME>

kubectl describe rolebinding <ROLE_BINDING_NAME>
```

- 클러스터 내에서 특정 리소스에 접근 및 작업을 할 수 있는 사용자 확인
```bash
> kubectl auth can-i create deployments
yes

> kubectl auth can-i delete nodes
no
```

- 관리자가 특정 사용자가 클러스터 내에서 수행할 수 있는 작업을 확인하는 방법
```bash
> kubectl auth can-i create deployments --as dev-user
no

> kubectl auth can-i create pods --as dev-user
yes
```


- 역할이 접근할 수 있는 리소스를 제한할 수 있다.
	- `resourceNames` 필드를 사용하여 가능하다.`
```bash
vi developer-role.yaml
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: developer
rules:
- apiGroups: [""]    # Core 그룹의 경우, API Group 섹션을 비울 수 있다.
  resources: ["pods"]
  verbs: ["list", "gets", "create", "update", "delete"]
  resourceNames: ["blue", "orange"]
```