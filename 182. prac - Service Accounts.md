### 182. prac - Service Accounts
- 클러스터의 서비스 어카운트 확인
```bash
controlplane ~ ➜  k get sa
NAME      SECRETS   AGE
default   0         7m56s
dev       0         20s
```

- default 서비스 어카운트의 토큰 확인
```bash
controlplane ~ ➜  kubectl describe sa default 
Name:                default
Namespace:           default
Labels:              <none>
Annotations:         <none>
Image pull secrets:  <none>
Mountable secrets:   <none>
Tokens:              <none>
Events:              <none>
```

- 현재 배포된 디플로이먼트가 사용하는 이미지 확인
```bash
controlplane ~ ➜  k describe deploy web-dashboard | grep -i image
    Image:      gcr.io/kodekloud/customimage/my-kubernetes-dashboard
```

- 파드에 토큰이 저장돼 있는 위치 확인
```bash
controlplane ~ ➜  k describe po web-dashboard-5f88cdc488-lcldz 
...
    Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-xb5ll (ro)
...
```

- 새로운 서비스 어카운트 생성
```bash
controlplane ~ ➜  k create sa dashboard-sa
serviceaccount/dashboard-sa created

controlplane ~ ➜  k get sa
NAME           SECRETS   AGE
dashboard-sa   0         5s
default        0         23m
dev            0         15m
```

- 새로운 토큰 생성
```bash
controlplane ~ ➜  k create token dashboard-sa
eyJhbGciOiJSUzI1NiIsImtpZCI6Iml3V3AxR2tyQmZYa1pqMnNUamJpellfY2hFSHF0Sms4NThrcHdfbUllUE0ifQ.eyJhdWQiOlsiaHR0cHM6Ly9rdWJlcm5ldGVzLmRlZmF1bHQuc3ZjLmNsdXN0ZXIubG9jYWwiLCJrM3MiXSwiZXhwIjoxNzU0NzMyMjQ0LCJpYXQiOjE3NTQ3Mjg2NDQsImlzcyI6Imh0dHBzOi8va3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2FsIiwianRpIjoiYWY0YmJiODQtZDAzMi00ZDBjLTg5NzctZGJkMzQyMGE0NmY2Iiwia3ViZXJuZXRlcy5pbyI6eyJuYW1lc3BhY2UiOiJkZWZhdWx0Iiwic2VydmljZWFjY291bnQiOnsibmFtZSI6ImRhc2hib2FyZC1zYSIsInVpZCI6IjczNTkyNjljLTA2N2ItNDc4MS1iYzQ0LWZjNWU5YmNiOTA2MCJ9fSwibmJmIjoxNzU0NzI4NjQ0LCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6ZGVmYXVsdDpkYXNoYm9hcmQtc2EifQ.a0MST7K57V0vmJpYYelcqAC05_yvSazcSy3Nr4jNdBhVzOwQwSElKxWUgSkVF57rKe2zlAzakq_T5R51AVvnyskVuqI7FSzMFn-X29Q9zvtaLegDlrCz5QJLssz1mpkCvlLmiYRrXkSv81TZN3aSW-om_8wujIwzj6o7xCzwcO3tGQRuj_1oOtj76FzNCQ3tTl5F0_FZaw-wiI9ec2cKRZ0MCQJCn_3XU-gFFuCDKy8zjp67swkrY23xDvVJstP3kIOHZaSuPT1Vz46ml91TeCWjVnYFXJAKnAV87x6uCLGjVBHeqpBE-UTP--rDGrfPw60nBTAc7a36rQdwnQkfQQ
```

- 새로 생성한 서비스 어카운트를 사용하도록 배포돼 있던 `web-dashboard` 디플로이먼트를 수정
	- 디플로이먼트에 서비스 어카운트를 지정하려면
	  `spec.template.spec.serviceAccountName` 필드를 추가해야 한다.
```bash
controlplane ~ ➜  k edit deployments.apps web-dashboard 
---
...
spec.template.spec.serviceAccountName: dashboard-sa
...
---
deployment.apps/web-dashboard edited
```