### 167. prac - Certificates API
```yaml
apiVersion: certificates.k8s.io/v1
kind: CertificateSigningRequest
metadata:
  name: akshay
spec:
  groups:
  - system:authenticated
  request: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURSBSRVFVRVNULS0tLS0KTUlJQ1ZqQ0NBVDRDQVFBd0VURVBNQTBHQTFVRUF3d0dZV3R6YUdGNU1JSUJJakFOQmdrcWhraUc5dzBCQVFFRgpBQU9DQVE4QU1JSUJDZ0tDQVFFQXg4YjViNnFGeFlBamxsRFF4TCtHTFU4cDF3czMyVk4vRTd1WXZ0VXBVRCtOCnF3M1RIdk9WeW56ZHh1Zmh0R2FDODczU1pzbXBCOHRHZnpqbURCeTlzZXhISUJJRDNzblltSjAweXg3YnAxS3UKSWt0ZlNpNEhNSHFoTmNxbHU4WkpPVjZIMjRRQ1E5UVVTNEJvaDFQMkl1OW5aakVGNmRScU40R0x5RWtzUVBNSgpWQmh1cG1hVkk0Zk53NnJrek95Z0xKWG9FNWFhSmw4T1lDZUpBRVp6ai9kRUpsZ01vSTk0eFN1TnNDWHFIbjdXClVOOThid0hvM1NoTGY1SkFrOEx6anczSW14REVPdjQzTWxyczFtS2VlV2VxWkF5R0pOc1JDNE1rUU5IZVAyR2wKZ1NuV2pWaUNlWnB6cHcwZzBhVE9UbHg3VU1BOWhZcVVkcUpkU044cDh3SURBUUFCb0FBd0RRWUpLb1pJaHZjTgpBUUVMQlFBRGdnRUJBSlZleEh0MXFnUnJSWGpTYUtQeTB4U3kvbkZCWTVQemZ4UllZY1JzNjJmSFl1NHh3M3hhCklJMStlQkZOYnRsR1Vrb0xZMVJjMGRoSXZaR1FkSklqTDk1RjhHY2pXZzY0MHQ1dnBIV08zT3lwUERMNHVtc1QKc3BVMDN0MUQwRGE3UWlNeGtLZ1RzQ01CZHhzT2ttM1RVcmZNb3ljcWxFZGRQN0VQeE1iRUNEYjVnZnJRNG9ESgoveFpDOHJ2dWttUW5lVzJxSlRYVFVQRjJwRjZSdExGV3RNU0xWUTNqR1QwbEd0RjdnRkxnVEVwcEJsVFlRdldoCjFNUWhocVl4dU9hVkpwMExwTnMvUDNTSHp5V2xCY2VyekFrN3MwYUVFVTJMUjN2cldocm1vSzROTlo4TUJHTE8KNXRHSGlzZnVTMFdwQWpMLzJhMms1VVIvUnc3cjNHVFBmTXc9Ci0tLS0tRU5EIENFUlRJRklDQVRFIFJFUVVFU1QtLS0tLQo=
  signerName: kuberenetes.io/kube-apiserver-client
  usages:
  - client auth
```

```bash
controlplane ~ ➜  k apply -f akshay-csr.yaml 
certificatesigningrequest.certificates.k8s.io/akshay created


controlplane ~ ➜  k get csr
NAME        AGE   SIGNERNAME                                    REQUESTOR                  REQUESTEDDURATION   CONDITION
akshay      6s    kuberenetes.io/kube-apiserver-client          kubernetes-admin           <none>              Pending
```

```bash
controlplane ~ ➜  k certificate approve akshay
certificatesigningrequest.certificates.k8s.io/akshay approved

controlplane ~ ➜  k get csr
NAME        AGE   SIGNERNAME                                    REQUESTOR                  REQUESTEDDURATION   CONDITION
akshay      66s   kuberenetes.io/kube-apiserver-client          kubernetes-admin           <none>              Approved
csr-h9njt   20m   kubernetes.io/kube-apiserver-client-kubelet   system:node:controlplane   <none>              Approved,Issued
```

```bash
controlplane ~ ➜  k get csr
NAME          AGE   SIGNERNAME                                    REQUESTOR                  REQUESTEDDURATION   CONDITION
agent-smith   10s   kubernetes.io/kube-apiserver-client           agent-x                    <none>              Pending
akshay        93s   kuberenetes.io/kube-apiserver-client          kubernetes-admin           <none>              Approved
csr-h9njt     21m   kubernetes.io/kube-apiserver-client-kubelet   system:node:controlplane   <none>              Approved,Issued

controlplane ~ ➜  k get csr agent-smith -o yaml
apiVersion: certificates.k8s.io/v1
kind: CertificateSigningRequest
metadata:
  creationTimestamp: "2025-08-07T18:03:50Z"
  name: agent-smith
  resourceVersion: "2096"
  uid: 15c103b1-9cdf-419a-aba7-b02e300968db
spec:
  extra:
    authentication.kubernetes.io/credential-id:
    - X509SHA256=7023c65df5a012a5eaaac35fd7acfe1ca5c9612b9017d2fd49bec2913010429b
  groups:
  - system:masters
  - system:authenticated
  request: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURSBSRVFVRVNULS0tLS0KTUlJQ1dEQ0NBVUFDQVFBd0V6RVJNQThHQTFVRUF3d0libVYzTFhWelpYSXdnZ0VpTUEwR0NTcUdTSWIzRFFFQgpBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRRE8wV0pXK0RYc0FKU0lyanBObzV2UklCcGxuemcrNnhjOStVVndrS2kwCkxmQzI3dCsxZUVuT041TXVxOTlOZXZtTUVPbnJEVU8vdGh5VnFQMncyWE5JRFJYall5RjQwRmJtRCs1eld5Q0sKeTNCaWhoQjkzTUo3T3FsM1VUdlo4VEVMcXlhRGtuUmwvanYvU3hnWGtvazBBQlVUcFdNeDRCcFNpS2IwVSt0RQpJRjVueEF0dE1Wa0RQUTdOYmVaUkc0M2IrUVdsVkdSL3o2RFdPZkpuYmZlek90YUF5ZEdMVFpGQy93VHB6NTJrCkVjQ1hBd3FDaGpCTGt6MkJIUFI0Sjg5RDZYYjhrMzlwdTZqcHluZ1Y2dVAwdEliT3pwcU52MFkwcWRFWnB3bXcKajJxRUwraFpFV2trRno4MGxOTnR5VDVMeE1xRU5EQ25JZ3dDNEdaaVJHYnJBZ01CQUFHZ0FEQU5CZ2txaGtpRwo5dzBCQVFzRkFBT0NBUUVBUzlpUzZDMXV4VHVmNUJCWVNVN1FGUUhVemFsTnhBZFlzYU9SUlFOd0had0hxR2k0CmhPSzRhMnp5TnlpNDRPT2lqeWFENnRVVzhEU3hrcjhCTEs4S2czc3JSRXRKcWw1ckxaeTlMUlZyc0pnaEQ0Z1kKUDlOTCthRFJTeFJPVlNxQmFCMm5XZVlwTTVjSjVURjUzbGVzTlNOTUxRMisrUk1uakRRSjdqdVBFaWM4L2RoawpXcjJFVU02VWF3enlrcmRISW13VHYybWxNWTBSK0ROdFYxWWllKzBIOS9ZRWx0K0ZTR2poNUw1WVV2STFEcWl5CjRsM0UveTNxTDcxV2ZBY3VIM09zVnBVVW5RSVNNZFFzMHFXQ3NiRTU2Q0M1RGhQR1pJcFVibktVcEF3a2ErOEUKdndRMDdqRytocGtueG11RkFlWHhnVXdvZEFMYUo3anUvVERJY3c9PQotLS0tLUVORCBDRVJUSUZJQ0FURSBSRVFVRVNULS0tLS0K
  signerName: kubernetes.io/kube-apiserver-client
  usages:
  - digital signature
  - key encipherment
  - server auth
  username: agent-x
status: {}
```

```bash
controlplane ~ ➜  k get csr
NAME          AGE   SIGNERNAME                                    REQUESTOR                  REQUESTEDDURATION   CONDITION
agent-smith   10s   kubernetes.io/kube-apiserver-client           agent-x                    <none>              Pending
akshay        93s   kuberenetes.io/kube-apiserver-client          kubernetes-admin           <none>              Approved
csr-h9njt     21m   kubernetes.io/kube-apiserver-client-kubelet   system:node:controlplane   <none>              Approved,Issued

controlplane ~ ➜  k get csr agent-smith -o yaml
apiVersion: certificates.k8s.io/v1
kind: CertificateSigningRequest
metadata:
  creationTimestamp: "2025-08-07T18:03:50Z"
  name: agent-smith
  resourceVersion: "2096"
  uid: 15c103b1-9cdf-419a-aba7-b02e300968db
spec:
  extra:
    authentication.kubernetes.io/credential-id:
    - X509SHA256=7023c65df5a012a5eaaac35fd7acfe1ca5c9612b9017d2fd49bec2913010429b
  groups:
  - system:masters
  - system:authenticated
  request: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURSBSRVFVRVNULS0tLS0KTUlJQ1dEQ0NBVUFDQVFBd0V6RVJNQThHQTFVRUF3d0libVYzTFhWelpYSXdnZ0VpTUEwR0NTcUdTSWIzRFFFQgpBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRRE8wV0pXK0RYc0FKU0lyanBObzV2UklCcGxuemcrNnhjOStVVndrS2kwCkxmQzI3dCsxZUVuT041TXVxOTlOZXZtTUVPbnJEVU8vdGh5VnFQMncyWE5JRFJYall5RjQwRmJtRCs1eld5Q0sKeTNCaWhoQjkzTUo3T3FsM1VUdlo4VEVMcXlhRGtuUmwvanYvU3hnWGtvazBBQlVUcFdNeDRCcFNpS2IwVSt0RQpJRjVueEF0dE1Wa0RQUTdOYmVaUkc0M2IrUVdsVkdSL3o2RFdPZkpuYmZlek90YUF5ZEdMVFpGQy93VHB6NTJrCkVjQ1hBd3FDaGpCTGt6MkJIUFI0Sjg5RDZYYjhrMzlwdTZqcHluZ1Y2dVAwdEliT3pwcU52MFkwcWRFWnB3bXcKajJxRUwraFpFV2trRno4MGxOTnR5VDVMeE1xRU5EQ25JZ3dDNEdaaVJHYnJBZ01CQUFHZ0FEQU5CZ2txaGtpRwo5dzBCQVFzRkFBT0NBUUVBUzlpUzZDMXV4VHVmNUJCWVNVN1FGUUhVemFsTnhBZFlzYU9SUlFOd0had0hxR2k0CmhPSzRhMnp5TnlpNDRPT2lqeWFENnRVVzhEU3hrcjhCTEs4S2czc3JSRXRKcWw1ckxaeTlMUlZyc0pnaEQ0Z1kKUDlOTCthRFJTeFJPVlNxQmFCMm5XZVlwTTVjSjVURjUzbGVzTlNOTUxRMisrUk1uakRRSjdqdVBFaWM4L2RoawpXcjJFVU02VWF3enlrcmRISW13VHYybWxNWTBSK0ROdFYxWWllKzBIOS9ZRWx0K0ZTR2poNUw1WVV2STFEcWl5CjRsM0UveTNxTDcxV2ZBY3VIM09zVnBVVW5RSVNNZFFzMHFXQ3NiRTU2Q0M1RGhQR1pJcFVibktVcEF3a2ErOEUKdndRMDdqRytocGtueG11RkFlWHhnVXdvZEFMYUo3anUvVERJY3c9PQotLS0tLUVORCBDRVJUSUZJQ0FURSBSRVFVRVNULS0tLS0K
  signerName: kubernetes.io/kube-apiserver-client
  usages:
  - digital signature
  - key encipherment
  - server auth
  username: agent-x
status: {}
```

```bash
controlplane ~ ➜  k certificate deny agent-smith
certificatesigningrequest.certificates.k8s.io/agent-smith denied


controlplane ~ ✖ k get csr
NAME          AGE     SIGNERNAME                                    REQUESTOR                  REQUESTEDDURATION   CONDITION
agent-smith   2m18s   kubernetes.io/kube-apiserver-client           agent-x                    <none>              Denied
akshay        3m41s   kuberenetes.io/kube-apiserver-client          kubernetes-admin           <none>              Approved
csr-h9njt     23m     kubernetes.io/kube-apiserver-client-kubelet   system:node:controlplane   <none>              Approved,Issued
```

```bash
controlplane ~ ➜  k get csr
NAME          AGE     SIGNERNAME                                    REQUESTOR                  REQUESTEDDURATION   CONDITION
agent-smith   2m47s   kubernetes.io/kube-apiserver-client           agent-x                    <none>              Denied
akshay        4m10s   kuberenetes.io/kube-apiserver-client          kubernetes-admin           <none>              Approved
csr-h9njt     23m     kubernetes.io/kube-apiserver-client-kubelet   system:node:controlplane   <none>              Approved,Issued

controlplane ~ ➜  k delete csr agent-smith 
certificatesigningrequest.certificates.k8s.io "agent-smith" deleted

controlplane ~ ➜  k get csr
NAME        AGE     SIGNERNAME                                    REQUESTOR                  REQUESTEDDURATION   CONDITION
akshay      4m22s   kuberenetes.io/kube-apiserver-client          kubernetes-admin           <none>              Approved
csr-h9njt   23m     kubernetes.io/kube-apiserver-client-kubelet   system:node:controlplane   <none>              Approved,Issued
```