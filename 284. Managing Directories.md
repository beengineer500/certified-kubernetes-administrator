### 284. Managing Directories
- kustomize를 사용하면, 각 환경/기능 별로 구성된 하위디렉터리 내부의 매니페스트들을 쉽게 관리하고 배포할 수 있다.

- 다음의 디렉터리 구조를 `kustomization.yaml`로 통합하여 관리 가능
```text
k8s/
└─ kustomization.yaml
   ├─ api/
   │  ├─ api-depl.yaml
   │  └─ api-service.yaml
   └─ db/
      ├─ db-depl.yaml
      └─ db-service.yaml
```

```yaml
# kustomization.yaml
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - api/api-depl.yaml
  - api/service.yaml
  - db/db-depl.yaml
  - db/db-service.yaml
```

- 각 하위 디렉터리별로 배포할 필요 없이, `kustomize`를 통해서 한번에 배포 가능
```bash
kustomize build k8s/ | kubectl apply -f -

# 또는
kubectl apply -k k8s/
```

#### Multiple Directories
- 하위 디렉터리가 더 많아질 경우, `kustomization.yaml`의 `resource` 섹션이 길어질 것이다.
- 이 경우, `kustomization.yaml` 파일을 하위 디렉터리 별로 생성함으로써 개선할 수 있다.
	- 그리고 각 `kustomization.yaml`은 위치한 하위 디렉터리 내 매니페스트들을 `resources` 섹션에 작성한다.
	- 루트 `kustomization.yaml`에는 각 하위 디렉터리 경로를 명시하기만 하면 된다.
```text
k8s/
├─ kustomization.yaml
├─ api/
│  └─ kustomization.yaml
├─ db/
│  └─ kustomization.yaml
├─ cache/
│  └─ kustomization.yaml
└─ kafka/
└─ kustomization.yaml
```

- `k8s/kustomization.yaml`
```yaml
resources:
  - api/
  - db/
  - cache/
  - kafka/
```

- `k8s/db/kustomization.yaml`
```bash
resources:
  - db-depl.yaml
  - db-service.yaml
```

- 이전과 동일하게 `kustomize`를 통해서 한번에 배포 가능하다.
```bash
kustomize build k8s/ | kubectl apply -f -

# 또는
kubectl apply -f k8s/
```