### 189. prac - Security Contexts
- 파드의 SecurityContext 확인
	- 별도 지정된 컨텍스트가 없으니, 기본값인 root
```bash
controlplane ~ ➜  k get po ubuntu-sleeper -o yaml
...
spec:
...
  securityContext: {}
...
```

- 파드의 `securityContext`를 `User ID 1010`으로 설정
	- 시큐리티 컨텍스틑 `kubectl edit`으로 변경할 수 없다. 파드를 삭제하고 시큐리티 컨텍스트를 설정 후, 재생성해야 한다.
```bash
controlplane ~ ➜  k get po ubuntu-sleeper -o yaml >> ubuntu-sleeper.yaml

controlplane ~ ➜  k delete po ubuntu-sleeper 
pod "ubuntu-sleeper" deleted

controlplane ~ ➜  vi ubuntu-sleeper.yaml 
---
...
spec:
  securityContext:
    runAsUser: 1010
...
---

controlplane ~ ➜  k apply -f ubuntu-sleeper.yaml 
pod/ubuntu-sleeper created
```

- 매니페스트를 확인하고, 시큐리티 컨텍스트에 의해 `web` 컨테이너를 실행하는 사용자 ID 식별
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: multi-pod
spec:
  securityContext:
    runAsUser: 1001
  containers:
  -  image: ubuntu
     name: web
     command: ["sleep", "5000"]
     securityContext:
      runAsUser: 1002

  -  image: ubuntu
     name: sidecar
     command: ["sleep", "5000"]
```

- `ubuntu-sleeper`파드를 root 사용자로 명령을 실행하도록 시큐리티 컨텍스트를 설정하고, `SYS_TIME` 기능세트를 추가
```bash
controlplane ~ ➜  cat ubuntu-sleeper.yaml 
apiVersion: v1
kind: Pod
metadata:
  name: ubuntu-sleeper
  namespace: default
spec:
  containers:
  - command:
    - sleep
    - "4800"
    image: ubuntu
    name: ubuntu-sleeper
    securityContext:
      capabilities:
        add:
        - SYS_TIME

controlplane ~ ➜  k apply -f ubuntu-sleeper.yaml 
pod/ubuntu-sleeper created
```

- `NET_ADMIN` 기능세트를 추가
```bash
controlplane ~ ➜  k delete -f ubuntu-sleeper.yaml --force
pod "ubuntu-sleeper" force deleted

controlplane ~ ➜  vi ubuntu-sleeper.yaml 
---
...
    securityContext:
      capabilities:
        add:
        - SYS_TIME
        - NET_ADMIN
---

controlplane ~ ➜  k apply -f ubuntu-sleeper.yaml 
pod/ubuntu-sleeper created
```