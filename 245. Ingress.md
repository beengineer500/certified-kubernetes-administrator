---
index: "[[ğŸ· Lecture Notes]]"
tags:
  - Kubernetes
  - Kubernetes/k8s
  - Kubernetes/Network
  - Kubernetes/Ingress
  - Kubernetes/Ingress-controller
created: 2025-05-26 09:20
status: 
source_url:
---
>[!info] Link
>- 

---

### 245. Ingress

- `ingress`ëŠ” ì™¸ë¶€ì—ì„œ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆëŠ” ë‹¨ì¼ URLì„ ì œê³µí•¨ìœ¼ë¡œì¨, ì‚¬ìš©ìê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•œë‹¤. ë˜í•œ, í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ URL í•˜ìœ„ ê²½ë¡œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ë¥¸ `svc`ë¡œ íŠ¸ë˜í”½ì„ ë¼ìš°íŒ…í•  ìˆ˜ ìˆë‹¤. SSL ë³´ì•ˆ êµ¬í˜„ë„ ê°€ëŠ¥í•˜ë‹¤.
- `ingress`ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ ë‚´ì¥ L7 ë¡œë“œ ë°¸ëŸ°ì„œë¡œ ìƒê°ì´ ê°€ëŠ¥í•˜ë‹¤.
- ì´ëŸ¬í•œ ë™ì‘ì„ `ingress` ì—†ì´ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„œëŠ” Nginx, HAproxy, Traefik ë“± ë¦¬ë²„ìŠ¤(ì—­ë°©í–¥)-í”„ë¡ì‹œë¥¼ íŒŒë“œë¡œ ë°°í¬í•˜ê³ , URL í•˜ìœ„ ê²½ë¡œì— ë”°ë¼ ì ì ˆí•œ `svc`ë¡œ íŠ¸ë˜í”½ì´ ë¼ìš°íŒ…ë˜ë„ì˜¥ ì„¤ì •í•´ì•¼ í•œë‹¤.
- `ingress`ë¥¼ ìœ„í•´ Nginx, HAProxy, Traefik ë“±ì„ ì‚¬ìš©í•˜ì—¬ ë°°í¬í•˜ëŠ” ì†”ë£¨ì…˜ì„ `ingress controller`ë¼ê³  í•œë‹¤.  ë¼ìš°íŒ… ê·œì¹™ì„ ì •ì˜í•˜ëŠ” ê·œì¹™ ì…‹ì€ `ingress resources`ë¼ê³  í•œë‹¤. 
- ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ `ingress controlle`ê°€ ë°°í¬ë˜ì§€ ì•ŠëŠ”ë‹¤. `ingress resources`ë¥¼ ë°°í¬í•˜ë”ë¼ë„, ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ë°°í¬ë˜ì§€ ì•ŠëŠ”ë‹¤.
- ì¸ê·¸ë ˆìŠ¤ ì»¨íŠ¸ë¡¤ëŸ¬ë¡œ ë°°í¬ ê°€ëŠ¥í•œ ì†”ë£¨ì…˜ ì¢…ë¥˜
	- GCE, ELB, Nginx, Contour, HAProxy, Traefik, Istio ë“±

- `nginx-ingress-controller` ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ì˜ˆì‹œ
	- nginxëŠ” ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ê¸° ìœ„í•´, ê¸°ë³¸ ì„¤ì •ì´ í•„ìš”í•˜ë‹¤. ì´ë¥¼ ì»¨íŠ¸ë¡¤ëŸ¬ ì´ë¯¸ì§€ì—ì„œ ë¶„ë¦¬í•˜ê³  í¸ë¦¬í•˜ê²Œ í•˜ê¸° ìœ„í•´ì„œëŠ” ë³„ë„ì˜ `ConfigMap`ì„ ì‘ì„±í•´ì„œ ë°°í¬í•´ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ì— ì ìš© ì‹œì¼œì•¼ í•œë‹¤.
```yaml
apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: nginx-ingress-controller
spec:
  replicas: 1
  selector:
    matchLabels:
      name: nginx-ingress
  template:
    metadata:
      lagels:
        name: nginx-ingress
    spec:
      containers:
		- name: nginx-ingress-controller
		  image: quay.io/kubernetes-ingress-controller/nginx-ingress-controller:0.21.0
	  args:
		- /nginx-inress-controller
		- --configmap=$(POD_NAMESPACE)/nginx-configuration
	  env:
	    - name: <POD_NAME>
	      valueFrom:
	        fieldRef:
	          fieldPath: metadata.name
	    - name: POD_NAMESPACE
	      valueFrom:
	        fieldRef:
	          fieldPath: metadata.namespace
	  ports:
	    - name: http:
	      containerPort: 80
	    - name: https
	      containerPort: 443
```

- ì¸ê·¸ë ˆìŠ¤ ì»¨íŠ¸ë¡¤ëŸ¬ ì™¸ë¶€ ë…¸ì¶œì„ ìœ„í•œ ì„œë¹„ìŠ¤
	- `nginx-ingress` ë ˆì´ë¸” ì„ íƒê¸°ë¥¼ ì‚¬ìš©í•˜ëŠ” NodePort ìœ í˜•
```yaml
apiVersion: v1
kind: Service
metadatae:
  name: nginx-ingress
spec:
  selectors:
    name: nginx-ingress
  type: NodePort
  ports:
  - port: 80
    targetPort: 80
    protocol: TCP
    name: http
  - port: 443
    targetPort: 443
    protocol: TCP
    name: https
```

- ì¸ê·¸ë ˆìŠ¤ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ë¥¼ ëª¨ë‹ˆí„°ë§í•˜ê¸° ìœ„í•´ ë‚´ì¥ëœ ì¶”ê°€ì ì¸ ê¸°ëŠ¥ì„ ë³´ìœ í•˜ê³  ìˆë‹¤. ì¸ê·¸ë ˆìŠ¤ ë¦¬ì†ŒìŠ¤ëŠ” ê¸°ë³¸ nginx ì„œë²„ë¥¼ êµ¬ì„±í•˜ê³  ë³€ê²½ì‚¬í•­ì„ ì ìš©í•œë‹¤..?
- ì¸ê·¸ë ˆìŠ¤ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì´ë¥¼ ìˆ˜í–‰í•˜ë ¤ë©´ `ServiceAccount`ê°€ í•„ìš”í•˜ë‹¤.
```bash
# configMap
kind: ConfigMap
apiVersion: v1
metadata:
  name: nginx-configuration
---
# Auth
apiVersion: v1
kind: ServiceAccount
metdata:
  name: nginx-ingress-serviceaccount
```

- `ingress reousrces`ëŠ” ì¸ê·¸ë ˆìŠ¤ ì»¨íŠ¸ë¡¤ëŸ¬ì— ì ìš©ë˜ëŠ” ê·œì¹™ ì…‹ì´ë‹¤.
	- ëª¨ë“  ì¸ë°”ìš´ë“œ íŠ¸ë˜í”½ì„ ë‹¨ì¼ ë…¸ë“œë¡œ ë¼ìš°íŒ…í•˜ê±°ë‚˜, URL ê²½ë¡œ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ë¥¸ ë…¸ë“œì— ë¼ìš°íŒ… í•˜ëŠ” ë“±ì˜ ì„¤ì •ì´ ê°€ëŠ¥í•˜ë‹¤. 
- ê°•ì˜ ê¸°ì¤€ìœ¼ë¡œ apiVersionì€ ë‹¤ìŒê³¼ ê°™ë‹¤. í•˜ì§€ë§Œ ìµœì‹  ë¦´ë¦¬ì¦ˆëŠ” ë‹¤ë¥¼í…Œë‹ˆ ì‹¤ì œ ë°°í¬ ì‹œì—ëŠ” ê³µì‹ ë¬¸ì„œ í™•ì¸ì´ í•„ìˆ˜ì´ë‹¤.
```yaml
apiVersion: extenstions/v1beta1
kind: ingress
metadata:
  name: ingress-wear
spec:
  backend:
    serviceName: wear-service
    servicePort: 80
```





---

# References
- 