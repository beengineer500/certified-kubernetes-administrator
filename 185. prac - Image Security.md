### 185. prac - Image Security
- 현재 배포된 디플로이먼트가 사용하는 이미지 확인
```bash
root@controlplane ~ ➜  k describe deploy web | grep -i image
    Image:         nginx:alpine
```

- 현재 배포된 디플로이먼트가 사용하는 이미지를 사설 레지스트리에서 이미지를 불러오도록 수정
```bash
k edit deploy web
---
...
spec.template.spec:
      containers:
      - image: myprivateregistry.com:5000/nginx:alpine
...
---
deployment.apps/web edited
```

- 업데이트한 후, 파드의 상태 확인
```bash
root@controlplane ~ ➜  k get po
NAME                   READY   STATUS             RESTARTS   AGE
web-7968dfbf7f-j8ss7   0/1     ImagePullBackOff   0          89s
```

- `docker-registry` 시크릿 생성
```bash
root@controlplane ~ ➜  k create secret docker-registry private-reg-cred \
> --docker-server=myprivateregistry.com:5000 \
> --docker-username=dock_user \
> --docker-password=dock_password \
> --docker-email=dock_user@myprivateregistry.com
secret/private-reg-cred created
```

- 디플로이먼트에 `imagePullSecrets` 필드 추가
```bash
root@controlplane ~ ➜  k edit deploy web
---
...
spec.template.spec:
      ...
      imagePullSecrets:
      - name: private-reg-cred
...
---
deployment.apps/web edited
```

- 파드 상태 확인
```bash
root@controlplane ~ ➜  k get po
NAME                  READY   STATUS    RESTARTS   AGE
web-67c9b9bf8-nfvsj   1/1     Running   0          8s
web-67c9b9bf8-qnct4   1/1     Running   0          9s
```