### 156. Authentication
- 인증 매커니즘을 통해 클러스터 접근 권한을 확보하는 것을 학습
- 쿠버네티스 내 배포된 애플리케이션에 관리 목적을 위해 접근하는 사용자 유형
	- Users
		- Admins
		- Developers
	- Serveice Accounts
		- Bots : 클러스터에 접근하는 프로세스, 서비스 또는 애플케이션
- Users
	- 쿠버네티스는 내부적으로 사용자 목록을 관리하지 않는다. 외부 소스로부터 사용자를 받아오는 등 관리를 수행한다.
		- `kubectl create user user-test` 같은 명령이 없다.
- Service Accounts
	- 서비스 어카운트는 쿠버네티스가 관리한다.
		- `kubectl create serviceAccount sa-test`, `kubectl get serviceAccount`는 가능하다. 

- Accounts
	- `kubectl`을 사용하든, 직접 API호출을 하든, 모든 사용자 액세스는 API 서버에 의해 관리된다.
	- `kube-apiserver`는 해당 요청을 처리하기 전에 사용자를 인증하는 절차를 가진다.
- `kube-apiserver`는 사용자를 어떻게 인증할까?
	- Static Password File
		- '패스워드, 사용자이름, 사용자ID, 그룹 정보'로 구성된 csv 파일을 사용자 정보 소스로 사용할 수 있다.
		- 파일 이름을 `kube-apiserver` 옵션으로 설정해야한다.
			- `--basic-auth-file=user-details.csv`
		- `kube-apiserver`를 직접 배포했다면, 설정한 뒤 `kube-apiserver.service`를 재시작해야 한다.
		- `kubeadm`으로 클러스터 구성 과정에서 `kube-apiserver` 파드가 배포된 거라면, 다음의 파일을 수정해야 한다.  수정을 저장하면 쿠버네티스가 `kube-apiserver`를 자동 재시작한다.
			- `/etc/kubernetes/manifests/kube-apiserver.yaml`
		- 토큰 기반 인증을 수행하며 API 요청
			- `curl -v -k https://<MASTER_NODE_IP>:6443/api/v1/pods -u "<USERNAME>:<PASSWORD>"`
	- Static Token File
		- '토큰, 사용자 이름, 사용자 ID, 그룹 정보'로 구성된 csv 파일을 사용자 정보 소스로 사용할 수 있다.
		- 파일 이름을 `kube-apiserver`옵션으로 설정해야 한다.
			- `--token-auth-file=user-token-details.csv`
		- 토큰 기반 인증을 수행하며 API 요청
			- `curl -v -k https://<MASTER_NODE_IP>:6443/api/v1/pods --header "Authorization: Bearer <TOKEN>"`
	- Certifications
	- Identity Services (LDAP ..)

- `Static Password, Token` 기반 인증은 패스워드와 토큰 값이 특정 파일에 명시적으로 저장된다. 따라서 이는 권장되지 않는 방법이다. 더불어 쿠버네티스 v1.19 이후로는  deprecated 되어, 이후의 버전에서는 사용 불가능하다.